<?php
 /**
 * @author Threema GmbH
 * @copyright Copyright (c) 2015 Threema GmbH
 */

namespace Threema\Console\Command;

use Threema\Console\Common;
use Threema\MsgApi\Tools\CryptTool;

class DerivePublicKey extends Base {
	function __construct() {
		parent::__construct('Derive Public Key',
			array('privateKey'),
			'Derive the public key that corresponds with the given private key.');
	}

	function doRun() {
		$privateKey = $this->getArgumentPrivateKey(0);

		Common::required($privateKey);

		$cryptTool = CryptTool::getInstance();

		$publicKey = $cryptTool->derivePublicKey($privateKey);
		Common::l(Common::convertPublicKey(bin2hex($publicKey)));
	}
}

